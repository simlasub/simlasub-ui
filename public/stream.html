<!DOCTYPE html>

<html>
<header>
	<meta charset="utf-8">
	<title>SIMLASUB</title>
	<meta name="viewport" content="width=device-width">

	<script type="text/javascript" src="broadway/Player/Decoder.js"></script>
    <script type="text/javascript" src="broadway/Player/YUVCanvas.js"></script>
    <script type="text/javascript" src="broadway/Player/Player.js"></script>
    <script type="text/javascript" src="broadway/Player/stream.js"></script>
    <script type="text/javascript" src="broadway/Player/mp4.js"></script>

	<!-- load stylesheet -->
	<link rel="stylesheet" href="style.css">
</header>

<body class="flex">
	<div class="box" id="stream">
	</div>
</body>


<script>
	var player = new Player({
		webgl: false,
		useWorker: false,
		workerFile: 'broadway/Player/Decoder.js'
	});

	player.canvas.id="stream";
	document.getElementById("stream").append(player.canvas);

	ws = new WebSocket("ws://" + location.hostname + ":1234");
	ws.binaryType = "arraybuffer";

	ws.onmessage = function(event) {
		var data = new Uint8Array(event.data);

		if(data.length === 0) {	
			console.warn("empty packet received");
			return;
		}

		console.log(data);

		player.decode(data);
	}
	</script>

</html>